!function(a){var b=angular.module("JavaModelo",["ng"]);b.config(["$httpProvider",function(a){a.interceptors.push("LoginInter"),a.interceptors.push("HostInter"),a.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]),function(){function a(a,b){if(!b)return a;"string"==typeof b&&(b=b.split("."));for(var c=0;c<b.length;c++)a=a[b[c]]||(a[b[c]]={});return a}function c(a,b){a.$scope&&!a.$scope.$$phase?a.$scope.$apply():b&&b.$apply&&!b.$$phase&&b.$apply()}function d(a,b){b||(b={}),this.nome=a,this.dataPath=b.dataPath||k.dataPath,this.size=b.size||k.size,this.page=b.page||k.page,this.url=b.url||k.url}function e(a){this.entidade=a instanceof Array?a[0]:a,this._size=this.entidade.size,this._page=this.entidade.page,this._param=[],this._join=[],this._order=[],this._data=null,this._url=this.entidade.url,this._method="",this.$scope=null,this._build=!1}function f(a,b){o[a]=function(a){return this.data(a).method(b).build().request()}}function g(b,d){o[b]=function(b,e,f){e||(e=this.entidade.nome),e=e.split(".");var g=a(b,e.slice(0,e.length-1));e=e[e.length-1];var h=this;return this[d](f).then(function(a){return g[e]=a,c(h,b),a})}}var h=angular.injector(["ng"],!0),i=h.get("$http"),j=h.get("$q"),k={contentType:"application/json",dataPath:"data.data",size:20,page:0,url:"/persistencia"},l={"Content-Type":k.contentType},m={},n={},o=e.prototype;o.size=function(a){return"number"==typeof a&&(this._size=a),this},o.page=function(a){return"number"==typeof a&&(this._page=a),this},o.order=function(a){if(a instanceof Array)for(var b in a){var c=a[b];"string"==typeof c&&this._order.push(c)}else"string"==typeof a&&this._order.push(a);return this},o.join=function(a){if(a instanceof Array)for(var b in a){var c=a[b];"string"==typeof c&&this._join.push(c)}else"string"==typeof a&&this._join.push(a);return this},o.param=function(a,b,c,d,e){return a?(d?"&"!==d&&"|"!==d&&(d="|"):d="&",void 0===e?(c=""+c,0!==c.indexOf('"')&&0!==c.indexOf("'")&&(c='"'+c),c.lastIndexOf('"')!==c.length-1&&c.lastIndexOf("'")!==c.length-1&&(c+='"')):e&&(c='"'+c+'"'),this._param.push(a+" "+b+" "+c+d),this):null},o.data=function(a){return this._data=a,this},o.method=function(a){return this._method=a,this},o.build=function(a){if(this._build&&!a)return this;var b="";for(var c in this._param)b+=this._param[c];b=b.replace(/[&\|\s]+$/,""),b&&(b="?"+b);var d=["size="+this._size,"page="+this._page];this._join.length>0&&d.push("join="+this._join.join(",")),this._order.length>0&&d.push("order="+this._order.join(",")),d=d.join(";"),d&&(d=";"+d);var e=this._url+"/"+this.entidade.nome;return this._url=e+d+b,this._build=!0,this},o.request=function(){var b=this;return i({method:this._method,url:this._url,headers:l,data:this._data||{}}).then(function(c){return a(c,b.entidade.dataPath)})},o.apply=function(a){return this.$scope=a,this},o.tipo=function(a){var b=this,c=m[b.entidade.nome];return!c||a?(b._url+="/tipo",b.method("GET").build().request().then(function(a){return m[b.entidade.nome]=a})):j.resolve(c)},f("get","GET"),f("put","PUT"),f("post","POST"),f("delete","DELETE"),g("tipoIn","tipo"),g("getIn","get"),g("putIn","put"),g("postIn","post"),g("deleteIn","delete"),b.provider("Entidades",[function(){this.defaults=k,this.$get=["context",function(a){var b=this,c={query:function(a){a instanceof Array||(a=[a]);for(var b=0;b<a.length;b++){var c=a[b];"string"==typeof c&&(a[b]=n[c])}return new e(a)},entidade:function(c,e,f){var g=n[c];return g&&!f?g:(e||(e={}),e.url||(e.url=a.services+k.url),g=new d(c,e),b[c]=n[c]=g,g)},get:function(a){return n[a]}};return c.eq=c.equal="=",c.ne=c.notEqual="!=",c.le=c.lowerThanOrEqualTo="<=",c.ge=c.greaterThanOrEqualTo=">=",c.lt=c.lowerThan="<",c.gt=c.greaterThan=">",c.nl=c.notLike="notlike",c.lk=c.like="like",c}]}])}(),b.provider("HostInter",[function(){var a=this;a.use=!1,a.url="",a.$get=["context",function(b){var c={request:function(c){return a.use&&(c.url=a.url+b.services+c.url),c}};return c}]}]),b.provider("LoginInter",[function(){var a=this;a.url="/login.jsp",a.ERRORCODE_LOGIN=401,a.$get=["context","$window",function(b,c){var d={response:function(d){if(d.data&&d.data.code===a.ERRORCODE_LOGIN){var e=c.location.origin;c.location=e+b.services+a.url}return d}};return d}]}]),b.provider("context",[function(){function a(a,c,d){if(!a)return"";if("string"!=typeof a)throw"To configure the context url string you must pass a string as the first parameter value.";return"undefined"==typeof c&&(c=!0),a=a.trim(),c?0!==a.indexOf("/")&&(a="/"+a):0===a.indexOf("/")&&(a=a.substring(1,a.length)),d?a.lastIndexOf("/")!==a.length-1&&(a+="/"):a.lastIndexOf("/")===a.length-1&&(a=a.substring(0,a.length-1)),b(a)}function b(a){return a.replace(/\/\/+/g,"/")}var c=this,d={root:function(){return c.context.root=a.apply(this,arguments),c.context.services=b(c.context.root+c.context.path.services),c.context.websocket=b(c.context.root+c.context.path.websocket),c},services:function(){return c.context.services=b(c.context.root+(c.context.path.services=a.apply(this,arguments))),c},websocket:function(){return c.context.websocket=b(c.context.root+(c.context.path.websocket=a.apply(this,arguments))),c},put:function(b){return c.context[b]=a.call(this,arguments[1],arguments[2],arguments[3]),c},context:{root:"",path:{}}};angular.extend(this,d),this.$get=[function(){return c.context}]}])}(window);